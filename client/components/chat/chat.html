<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<div id="chatApp" ng-controller="ChatCtrl">
  <div class="chat-container clearfix">
	<span class="closer glyphicon glyphicon-remove" aria-hidden="true" onclick="showChat()"></span>
    <div class="people-list" id="people-list">  
      <div class="input-group">
		<div class="input-group-addon"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></div>
        <input class="form-control" type="text" placeholder="Search friends" ng-model="searchUsers" />
      </div>
      <ul class="list">
        <li class="chat-user" ng-class="{selected : selectedUser === user.nickname}" ng-click="loadChat($event)" nickname="{{user.nickname}}" socketid="{{user.socketid}}" ng-repeat="user in users | filter: searchUsers" ng-if="user.socketid != mysocketid && isFriend(user.id)">
          <img class="profilepicture" src="http://localhost:9000/assets/images/users/{{user.nickname}}.jpg" onerror="this.src='http://localhost:9000/assets/images/users/default-avatar.jpg'" alt="{{user.nickname}}" />
          <div class="about">
            <div class="name" style="color:#fff;">{{user.nickname}} </div>
            <div class="status">
              <i class="fa fa-circle online"></i> online 
            </div>
          </div>
        </li>
        <li class="clearfix" ng-hide="users.length">No users online!</li>
      </ul>
    </div>
    
    <div class="chat">
      <div id="chat-holder" ng-show="activeChat">
        <div class="chat-header clearfix">
          <img class="chosenuseravatar" src="http://localhost:9000/assets/images/users/{{selectedUser}}.jpg" alt="avatar" />
          
          <div class="chat-about">
            <div class="chat-with">Chat with {{selectedUser}}</div>
            <div class="chat-num-messages">{{msgcount}} Messages</div>
          </div>
        </div> <!-- end chat-header -->
        
        <div class="chat-history" id="chat-data">
          <ul>
            <li class="clearfix" ng-repeat="msg in conversation">
              <div ng-class="{'message-data': true, 'align-right' : msg.from !== mynickname}">

              <div ng-if="msg.from != mynickname">
                <span class="message-data-name">{{msg.from}} </span> <i class="fa fa-circle online"></i>
				<span class="message-data-time">{{msg.time * 1000 | date: 'h:mm a' }}</span> &nbsp; &nbsp;
              </div>

              <div ng-if="msg.from == mynickname">
                <span class="message-data-name">{{msg.from}} </span> <i class="fa fa-circle online"></i>
                <span class="message-data-time">{{msg.time * 1000 | date: 'h:mm a' }}</span> &nbsp; &nbsp;
              </div>

              </div>
              <div ng-class="{'message':true, 'other-message float-right':msg.from !== mynickname, 'my-message':msg.from === mynickname}">
                {{msg.message}}
              </div>
            </li>
          </ul>
          
        </div> <!-- end chat-history -->
        
        <div class="chat-message clearfix">
          <textarea ng-model="message" ng-keyup="(!$event.shiftKey && ($event.keyCode == 13)) ? sendMessage() : ''" placeholder ="your message ..." rows="3"></textarea>
        </div> <!-- end chat-message -->
      </div> <!-- end chat-holder -->

      <div id="empty-chat" ng-show="emptyChat">
        <!--<i class="fa fa-comment lg"></i>-->
      </div>    
    </div> <!-- end chat -->  
  </div> <!-- end container -->
 </div>